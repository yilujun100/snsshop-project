<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>秒降活动页</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<meta name="format-detection" content="telephone=no">
		<!-- style base -->
		<link rel="stylesheet" href="../../css/base.css">
		<!-- style common -->
		<link rel="stylesheet" href="../../css/common.css">
		<!-- style layout reduce price -->
		<link rel="stylesheet" href="../../css/layout_reduce_price2.css">
	</head>
	<body>
		<div class="viewport v-reduce-price">
			<div class="reduce-price">
				<!-- banner -->
				<div class="banner">
					<img src="../../images/reduce_price2/banner.jpg" width="100%" alt="">
				</div>
				<!-- session -->
				<div class="session">
					<!-- session-end: 已结束 session-ongoing: 进行中 session-begin: 即将开始 -->
					<ul class="session-title clearfix">
						<li><a href="javascript:;">10:00<br></a></li>
						<li><a href="javascript:;">16:00<br></a></li>
						<li><a href="javascript:;">20:00<br></a></li>
					</ul>
				</div>
				<!-- count down -->
				<!-- <div class="count-down-start">本场次即将开始</div> -->
				<!-- <div class="count-down-end">本场次已结束</div> -->
				<div class="count-down">
					<em>距离本场结束:</em>
					<ul>
						<li class="hour">19</li>
						<li class="sepe">:</li>
						<li class="min">40</li>
						<li class="sepe">:</li>
						<li class="sec">33</li>
					</ul>
					<a href="#rules" class="btn-rules">活动规则</a>
				</div>
				<div class="count-down-start1">
					<em>距离本场开始:</em>
					<ul>
						<li class="hour">19</li>
						<li class="sepe">:</li>
						<li class="min">40</li>
						<li class="sepe">:</li>
						<li class="sec">33</li>
					</ul>
					<a href="#rules" class="btn-rules">活动规则</a>
				</div>
				<div class="count-down-start2">
					<em>距离本场开始:</em>
					<ul>
						<li class="hour">19</li>
						<li class="sepe">:</li>
						<li class="min">40</li>
						<li class="sepe">:</li>
						<li class="sec">33</li>
					</ul>
					<a href="#rules" class="btn-rules">活动规则</a>
				</div>
				<div class="count-down-start3">
					<em>距离本场开始:</em>
					<ul>
						<li class="hour">19</li>
						<li class="sepe">:</li>
						<li class="min">40</li>
						<li class="sepe">:</li>
						<li class="sec">33</li>
					</ul>
					<a href="#rules" class="btn-rules">活动规则</a>
				</div>
				<!-- recharge -->
				<div class="recharge">
					<div class="recharge-inner clearfix">
						<div class="user-avatar fl">
							<img src="../../images/reduce_price2/uspic.jpg" width="40" height="40" alt="">
							<h3>我是头像</h3>
						</div>
						<div class="recharge-entry fr">
							<a href="#">充值500元获取活动资格</a>
							<p>500元可用于夺宝或拍卖本活动页商品</p>
						</div>						
					</div>
				</div>
				<!-- goods list -->
				<div class="goods">
					<div class="goods-hd">
						<img src="../../images/reduce_price2/title.jpg" width="100%" alt="">
					</div>
					<div class="goods-con">
						<div class="session-tab-con">
							<!-- 10:00点场次 -->
							<div class="session-1">																								
								<div class="goods-item">
									<div class="goods-thumb">
										<img src="../../images/reduce_price2/goods.jpg" width="60%" alt="">
										<span class="goods-corner">剩余<br>3件</span>
									</div>
									<div class="goods-info">
										<h3 class="goods-title">iPhone7 128G</h3>
										<div class="goods-price clearfix">
											<span class="fl">
												<p><label>抢购价</label><strong>￥8188</strong></p>
												<p>往期最低抢购价￥6088</p>
											</span>
											<span class="fr">
												<p><label>已降价</label><strong>￥0</strong></p>
												<p><a href="javascript:;" class="btn-view-detail">查看详情<img src="../../images/reduce_price2/ico.png" alt=""></a></p>
											</span>
										</div>
										<a href="#" class="btn-start">即将开始</a>
									</div>
								</div>
								<div class="goods-item">
									<div class="goods-thumb">
										<img src="../../images/reduce_price2/goods.jpg" width="60%" alt="">
										<span class="goods-corner">剩余<br>3件</span>
									</div>
									<div class="goods-info">
										<h3 class="goods-title">iPhone7 128G</h3>
										<div class="goods-price clearfix">
											<span class="fl">
												<p><label>抢购价</label><strong>￥8188</strong></p>
												<p>往期最低抢购价￥6088</p>
											</span>
											<span class="fr">
												<p><label>已降价</label><strong>￥0</strong></p>
												<p><a href="javascript:;" class="btn-view-detail">查看详情<img src="../../images/reduce_price2/ico.png" alt=""></a></p>
											</span>
										</div>
										<a href="#" class="btn-start">即将开始</a>
									</div>
								</div>
							</div>
							<!-- 16:00点场次 -->
							<div class="session-2">																
								<div class="goods-item">
									<div class="goods-thumb">
										<img src="../../images/reduce_price2/goods.jpg" width="60%" alt="">
										<span class="goods-corner">剩余<br>3件</span>
									</div>
									<div class="goods-info">
										<h3 class="goods-title">iPhone7 128G</h3>
										<div class="goods-price clearfix">
											<span class="fl">
												<p><label>抢购价</label><strong>￥8188</strong></p>
												<p>往期最低抢购价￥6088</p>
											</span>
											<span class="fr">
												<p><label>已降价</label><strong>￥0</strong></p>
												<p><a href="javascript:;" class="btn-view-detail">查看详情<img src="../../images/reduce_price2/ico.png" alt=""></a></p>
											</span>
										</div>
										<a href="#" class="btn-end">已结束</a>
									</div>
								</div>
								<div class="goods-item">
									<div class="goods-thumb">
										<img src="../../images/reduce_price2/goods.jpg" width="60%" alt="">
										<span class="goods-corner">剩余<br>3件</span>
									</div>
									<div class="goods-info">
										<h3 class="goods-title">iPhone7 128G</h3>
										<div class="goods-price clearfix">
											<span class="fl">
												<p><label>抢购价</label><strong>￥8188</strong></p>
												<p>往期最低抢购价￥6088</p>
											</span>
											<span class="fr">
												<p><label>已降价</label><strong>￥0</strong></p>
												<p><a href="javascript:;" class="btn-view-detail">查看详情<img src="../../images/reduce_price2/ico.png" alt=""></a></p>
											</span>
										</div>
										<a href="#" class="btn-end">已结束</a>
									</div>
								</div>
							</div>
							<!-- 20:00点场次 -->
							<div class="session-3" style="display: block;">								
								<div class="goods-item">
									<div class="goods-thumb">
										<img src="../../images/reduce_price2/goods.jpg" width="60%" alt="">
										<span class="goods-corner">剩余<br>3件</span>
									</div>
									<div class="goods-info">
										<h3 class="goods-title">iPhone7 128G01往期最低抢购价￥6088往期最低抢购价￥6088往期最低抢购价￥6088</h3>
										<div class="goods-price clearfix">
											<span class="fl">
												<p><label>抢购价</label><strong>￥8188</strong></p>
												<p>往期最低抢购价￥6088</p>
											</span>
											<span class="fr">
												<p><label>已降价</label><strong>￥1045</strong></p>
												<p><a href="javascript:;" class="btn-view-detail">查看详情<img src="../../images/reduce_price2/ico.png" alt=""></a></p>
											</span>
										</div>
										<a href="#" class="btn-buy">立即抢购</a>
									</div>
								</div>
								<div class="goods-item">
									<div class="goods-thumb">
										<img src="../../images/reduce_price2/goods.jpg" width="60%" alt="">
										<span class="goods-corner">剩余<br>3件</span>
									</div>
									<div class="goods-info">
										<h3 class="goods-title">iPhone7 128G</h3>
										<div class="goods-price clearfix">
											<span class="fl">
												<p><label>抢购价</label><strong>￥8188</strong></p>
												<p>往期最低抢购价￥6088</p>
											</span>
											<span class="fr">
												<p><label>已降价</label><strong>￥0</strong></p>
												<p><a href="javascript:;" class="btn-view-detail">查看详情<img src="../../images/reduce_price2/ico.png" alt=""></a></p>
											</span>
										</div>
										<a href="#" class="btn-buy">立即抢购</a>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<!-- rules -->
				<div class="rules" id="rules">
					<div class="rules-hd">
						<h3>活动规则</h3>
					</div>
					<div class="rules-con">
						<p><em>1</em>活动时间：2016年11月23日10：00-22:00；</p>
						<p><em>2</em>本次活动仅限活动期间内单笔充值满500元的用户；<b>充值的500元，可用于购买本活动页的商品，也可用于夺宝；</p>
						<p><em>3</em>秒降夺宝专场内商品一天分3场开卖，开场时间为：10:00 、 16:00、20:00；</p>
						<p><em>4</em>每场开始后，该场内商品以每5秒降价5元速度降价，最低降至0元；</p>
						<p><em>5</em>商品初始价格为百分好礼夺宝价，降价过程中，vip用户可以在任意价格拍下该商品，先拍先得；</p>
						<p><em>6</em>活动商品仅能通过夺宝币余额支付，请提前充值；<a href="#">立即充值&gt;&gt;</a></p>
						<p><em>7</em>若有多名用户同时点击立即抢购按钮，最先点击按钮用户获得该商品支付资格；</p>
						<p><em>8</em>用户在支付过程中，所支付商品停止降价并处于锁定状态，不能再被其他用户购买</p>
						<p><em>9</em>进入支付页面用户，需在2分钟内完成支付，否则支付失败，商品解除锁定，可以被抢购，同时继续降价；</p>
						<p><em>10</em><b>若用户连续2次中断支付，为保证其他用户能正常抢购，该用户将取消参加活动资格；</b></p>
						<p><em>11</em>活动期间内，每个商品，每位用户可购买多件;;</p>
						<p><em>12</em>活动期间充值参与竞拍用户，若未能成功拍到商品，余额可用于参与夺宝，但不予退款；</p>
						<p><em>13</em>由于手机性能、网络等原因，实际结算价格可能与结算价格有轻微误差，最终成交价与竞拍成功用户已夺宝后台记录为准；</p>
						<p><em>14</em>特别声明：若发现用户在活动过程中使用不正当手段参与，活动主办方有权取消其参与活动资格与礼品。</p>
						<p><em>15</em>法律范围内，解释权归百分好礼所有。</p>
					</div>
				</div>
			</div>
		</div>
	
		<div class="fixed-nav">
	        <a href="home.html"><i class="icon-nav icon-home"></i>首页</a>
	        <a href="share.html"><i class="icon-nav icon-camera"></i>晒单</a>
	        <a href="#"><i class="icon-nav icon-acti"></i>活动</a>
	        <a href="cart.html"><i class="icon-nav icon-cart"></i>清单</a>
	        <a href="personal_center.html"><i class="icon-nav icon-avatar"></i>个人中心</a>
		</div>

		<!-- popup start -->
		<div class="mask" style="z-index: 103;"></div>
		<div class="popup-win">
			<div class="popup-hd"><img src="../../images/reduce_price2/recharge_success2.png" width="100%" alt="">
				<div class="putxt">
					<h3>您来啦</h3>
					<p>充值500元才可参加活动哦！</p>
				</div>
			</div>
			<div class="popup-con">
				<a href="#" class="btn-popup">立即充值</a>
			</div>
			<a href="javascript:;" class="btn-popup-close">关闭</a>
		</div>
		<div class="popup-detail">
			<div class="view-detail">
				<div class="view-detail-hd">
					<ul class="clearfix">
						<li>轮次</li>
						<li>成交价</li>
						<li>得主</li>
					</ul>
				</div>
				<div class="view-detail-con">
					<table>
						<tbody>
							<tr>
								<td>1</td>
								<td>￥15</td>
								<td>微信用户超人</td>
							</tr>
							<tr>
								<td>2</td>
								<td>￥20</td>
								<td>恰恰香瓜子</td>
							</tr>
							<tr>
								<td>3</td>
								<td>￥20</td>
								<td>财神爷6666666</td>
							</tr>
							<tr>
								<td>4</td>
								<td>￥15</td>
								<td>微信用户超人</td>
							</tr>
							<tr>
								<td>5</td>
								<td>￥15</td>
								<td>微信用户超人微信用户</td>
							</tr>
							<tr>
								<td>6</td>
								<td>￥15</td>
								<td>微信用户超人</td>
							</tr>
							<tr>
								<td>7</td>
								<td>￥15</td>
								<td>恰恰香瓜子</td>
							</tr>
							<tr>
								<td>8</td>
								<td>￥15</td>
								<td>微信用户超人微信</td>
							</tr>
							<tr>
								<td>9</td>
								<td>￥15</td>
								<td>微信用户超人</td>
							</tr>
							<tr>
								<td>10</td>
								<td>￥15</td>
								<td>财神爷财神爷66666</td>
							</tr>
							<tr>
								<td>11</td>
								<td>￥15</td>
								<td>微信用户超人</td>
							</tr>
						</tbody>
						<!-- <tfoot>
							<tr>
								<td colspan="3">
									<a href="#" class="btn-ok">好的</a>
								</td>
							</tr>
						</tfoot> -->
					</table>					
				</div>
				<div class="view-detail-bott">
					<a href="javascript:;" class="btn-ok">好的</a>
				</div>
			</div>
		</div>
		<div class="popup-recharge-succ">
			<div class="popup-recharge-con">
				<img src="../../images/reduce_price2/recharge_success.png" width="100%" alt="">
			</div>
			<div class="popup-recharge-bott">
				<a href="javascript:;" class="btn-thanks">不,谢谢</a>
				<a href="#" class="btn-visit">立即充值</a>
			</div>
			<a href="javascript:;" class="btn-recharge-close">关闭</a>
		</div>
		<!-- popup end -->
		<!-- jquery lib script -->
		<script src="../../js/jquery-2.1.4.min.js" type="text/javascript"></script>
		<!-- jquery common script -->
		<script src="../../js/lib.js" type="text/javascript"></script>
		<script>
			$(function(){	

				var aSessionTime = [
					{
						startTime: '2016/11/10 10:00:00',
						endTime: '2016/11/10 15:59:59'
					},
					{
						startTime: '2016/11/10 16:00:00',
						endTime: '2016/11/10 19:59:59'
					},
					{
						startTime: '2016/11/10 20:00:00',
						endTime: '2016/11/10 21:59:59'
					}
				];	

				var currentTime = '2016/11/10 21:59:50', // 系统当前时间 @后台：这里取后台对应的时间
					timer = null,
					session = $('.session'),
					sessionLi = session.find('li'),
					currentTimeToStr = new Date(currentTime).getTime(),
					begin1 = new Date(aSessionTime[0].startTime).getTime(),
					begin2 = new Date(aSessionTime[1].startTime).getTime(),
					begin3 = new Date(aSessionTime[2].startTime).getTime();	

				if (currentTimeToStr < begin1) {
					sessionLi.each(function() {
						$(this).addClass('session-begin').find('a').append('<span>即将开始</span>');
						var endTime1 = aSessionTime[0].startTime;		
						var endTime2 = aSessionTime[1].startTime;			
						var endTime3 = aSessionTime[2].startTime;			
						var diff1 = (new Date(endTime1).getTime() - new Date(currentTime).getTime()) / 1000;
						var diff2 = (new Date(endTime2).getTime() - new Date(currentTime).getTime()) / 1000;
						var diff3 = (new Date(endTime3).getTime() - new Date(currentTime).getTime()) / 1000;
						parseFn('.count-down-start1', diff1);
						parseFn('.count-down-start2', diff2);						
						parseFn('.count-down-start3', diff3);												
						showStart1();
						$('.session-tab-con .goods-info > a').remove();
						$('.session-tab-con > div').find('span p:last-child').hide();	
						$('.session-title li').removeClass('session-highlight');
						$('.session-tab-con > div').eq(0).show().siblings().hide();
						$('.session-tab-con .goods-info').append('<a href="javascirpt:;" class="btn-start">即将开始</a>');
					});

					sessionLi.eq(0).addClass('session-begin session-highlight');
				} else if (currentTimeToStr >= begin1 && currentTimeToStr < begin2) {
					sessionLi.eq(0).addClass('session-ongoing session-highlight').find('a').append('<span>进行中</span>');	
					sessionLi.eq(1).addClass('session-begin').find('a').append('<span>即将开始</span>');					
					sessionLi.eq(2).addClass('session-begin').find('a').append('<span>即将开始</span>');
					var endTime1 = aSessionTime[0].endTime;
					var endTime2 = aSessionTime[1].startTime;
					var endTime3 = aSessionTime[2].startTime;
					var diff1 = (new Date(endTime1).getTime() - new Date(currentTime).getTime()) / 1000;
					var diff2 = (new Date(endTime2).getTime() - new Date(currentTime).getTime()) / 1000;
					var diff3 = (new Date(endTime3).getTime() - new Date(currentTime).getTime()) / 1000;
					parseFn('.count-down', diff1);			
					parseFn('.count-down-start2', diff2);			
					parseFn('.count-down-start3', diff3);			
					showCountDown();
					$('.session-tab-con .goods-info > a').remove();	
					$('.session-tab-con > div:gt(0)').find('span p:last-child').hide();	
					$('.session-tab-con > div').eq(0).show().siblings().hide();
					$('.session-tab-con > div').eq(0).find('.goods-info').append('<a href="#" class="btn-buy">立即抢购</a>');
					$('.session-tab-con > div:gt(0)').find('.goods-info').append('<a href="javascirpt:;" class="btn-start">即将开始</a>');
				} else if (currentTimeToStr >= begin2 && currentTimeToStr < begin3) {
					sessionLi.eq(0).addClass('session-end').find('a').append('<span>已结束</span>');	
					sessionLi.eq(1).addClass('session-ongoing session-highlight').find('a').append('<span>进行中</span>');					
					sessionLi.eq(2).addClass('session-begin').find('a').append('<span>即将开始</span>');
					var endTime1 = aSessionTime[1].endTime;
					var endTime2 = aSessionTime[2].startTime;
					var diff1 = (new Date(endTime1).getTime() - new Date(currentTime).getTime()) / 1000;
					var diff2 = (new Date(endTime2).getTime() - new Date(currentTime).getTime()) / 1000;
					parseFn('.count-down', diff1);	
					parseFn('.count-down-start3', diff2);
					showCountDown();
					$('.session-tab-con .goods-info > a').remove();
					$('.session-tab-con > div:gt(1)').find('span p:last-child').hide();	
					$('.session-tab-con > div').eq(1).show().siblings().hide();
					$('.session-tab-con > div').eq(1).find('.goods-info').append('<a href="#" class="btn-buy">立即抢购</a>');
					$('.session-tab-con > div').eq(0).find('.goods-info').append('<a href="javascript:;" class="btn-end">已结束</a>');	
					$('.session-tab-con > div').eq(2).find('.goods-info').append('<a href="javascirpt:;" class="btn-start">即将开始</a>');	
				} else if (currentTimeToStr >= begin3) {
					var endTime1 = 	aSessionTime[2].endTime;
					var endTime1ToStr = new Date(endTime1).getTime();
					if (currentTimeToStr > endTime1ToStr) {
						sessionLi.each(function(){
								$(this).addClass('session-end').find('a').append('<span>已结束</span>');
						});
						showEnd();
						$('.session-tab-con .goods-info > a').remove();
						$('.session-tab-con > div').eq(2).show().siblings().hide();	
						$('.session-tab-con > div').find('.goods-info').append('<a href="javascript:;" class="btn-end">已结束</a>');

					} else {
						sessionLi.eq(0).addClass('session-end').find('a').append('<span>已结束</span>');	
						sessionLi.eq(1).addClass('session-end').find('a').append('<span>已结束</span>');					
						sessionLi.eq(2).addClass('session-ongoing session-highlight').find('a').append('<span>进行中</span>');
						var diff1 = (new Date(endTime1).getTime() - new Date(currentTime).getTime()) / 1000;
						parseFn('.count-down', diff1);	
						showCountDown();	
						$('.session-tab-con .goods-info > a').remove();
						$('.session-tab-con > div').eq(2).show().siblings().hide();	
						$('.session-tab-con > div').eq(2).find('.goods-info').append('<a href="#" class="btn-buy">立即抢购</a>');
						$('.session-tab-con > div:lt(2)').find('.goods-info').append('<a href="javascirpt:;" class="btn-end">已结束</a>');						
					}		
				}


				// tab
				var aTit = $('.session-title a');
				aTit.each(function(i) {
					var _this = $(this);	

			        _this.on('click', function(){
			            _this.parent().addClass('session-highlight').siblings().removeClass('session-highlight');
			            $('.session-tab-con > div').eq(i).show().siblings().hide();
			            if (i == 0) { // 10点场
			            	if (currentTimeToStr < begin1) {	
								showStart1();
			            	} else if (currentTimeToStr >= begin1 && currentTimeToStr < begin2) { 
								showCountDown();
			            	} else if (currentTimeToStr >= begin2 && currentTimeToStr < begin3) {
								showEnd();
			            	} else if (currentTimeToStr >= begin3) {
								showEnd();
			            	}
			            } else if (i == 1) { // 16点场
			            	if (currentTimeToStr < begin1) { 
								showStart2();     		
			            	} else if (currentTimeToStr >= begin1 && currentTimeToStr < begin2) { 
								showStart2();
			            	} else if (currentTimeToStr >= begin2 && currentTimeToStr < begin3) {
								showCountDown();
			            	} else if (currentTimeToStr >= begin3) {
								showEnd();
			            	}
			            } else if (i == 2) { // 20点场
			            	if (currentTimeToStr < begin1) {
								showStart3();
			            	} else if (currentTimeToStr >= begin1 && currentTimeToStr < begin2) {   
								showStart3();
			            	} else if (currentTimeToStr >= begin2 && currentTimeToStr < begin3) {
								showStart3();
			            	} else if (currentTimeToStr >= begin3) {
			            		if (currentTimeToStr > new Date(aSessionTime[2].endTime).getTime()) {
			            			showEnd();
			            		} else {
									showCountDown();
			            		}
			            	}
			            }
			            return false;
			        });
				});

				// popup
				$('.recharge-entry a').on('click', function() {
					$('.mask, .popup-win').show();
					return false;
				});
				$('.btn-popup-close').on('click', function() {
					$('.mask, .popup-win').hide();
				});

				$('.btn-view-detail').on('click', function() {
					$('.mask, .popup-detail').show();
				});
				$('.btn-ok').on('click', function() {
					$('.mask, .popup-detail').hide();
				});

				// 充值达标弹窗
				$('.fixed-nav a').eq(4).on('click', function() {
					$('.mask, .popup-recharge-succ').show();
					return false;
				});
				$('.btn-thanks, .btn-recharge-close').on('click', function() {
					$('.mask, .popup-recharge-succ').hide();
				});


				function parseFn(ele, time) {
					tmplHtml(ele, time);
					timer = setInterval(function() {
						tmplHtml(ele, time-=1);
					}, 1000);
				} 

				function tmplHtml(ele, time) {
					var countDownObj = $(ele),
						hour = countDownObj.find('.hour'),
						min = countDownObj.find('.min'),
						sec = countDownObj.find('.sec');
					var h, m, s;

					h = toDouble(Math.floor(time / 60 / 60 % 24));
					m = toDouble(Math.floor(time / 60 % 60));
					s = toDouble(Math.floor(time % 60));

					if (time >= 0) {
						hour.html(h);
						min.html(m);
						sec.html(s);						
					} else {
						clearInterval(timer);
					}
				}

				function toDouble(num) {
					return num < 10 ? '0' + num : num;
				}

				function showStart1() {
					$('.count-down-start1').show();
					$('.count-down, .count-down-end, .count-down-start2, .count-down-start3').hide();
				}

				function showStart2() {
					$('.count-down-start2').show();
					$('.count-down, .count-down-end, .count-down-start1, .count-down-start3').hide();
				}

				function showStart3() {
					$('.count-down-start3').show();
					$('.count-down, .count-down-end, .count-down-start1, .count-down-start2').hide();
				}

				function showEnd() {
					$('.count-down-end').show();
					$('.count-down, .count-down-start1, .count-down-start2, .count-down-start3').hide();
				}

				function showCountDown() {
					$('.count-down').show();
					$('.count-down-end, .count-down-start1, .count-down-start2, .count-down-start3').hide();
				}
			});
		</script>
	</body>
</html>