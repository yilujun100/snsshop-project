<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>选择参与数量</title>
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="author" content="">
		<meta name="Copyright" content="">
		<meta name="Keywords" content="">
		<meta name="Description" content="">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<meta name="format-detection" content="telephone=no">
		<!-- style base -->
		<link rel="stylesheet" href="css/base.css">
		<!-- style common -->
		<link rel="stylesheet" href="css/common.css">
		<!-- layer skin extend style -->
		<link rel="stylesheet" href="css/layer_skin_extend.css">
		<!-- style mobiscroll -->
		<link rel="stylesheet" href="css/mobiscroll/mobiscroll.animation.css">
		<link rel="stylesheet" href="css/mobiscroll/mobiscroll.icons.css">
		<link rel="stylesheet" href="css/mobiscroll/mobiscroll.frame.css">
		<link rel="stylesheet" href="css/mobiscroll/mobiscroll.scroller.css">
		<!-- style layout -->
		<link rel="stylesheet" href="css/layout.css">		
	</head>
	<body>
		<div class="viewport v-participate-num">
			<!-- participate num start -->
			<div class="participate-num">
				<div class="parti-num-hd">
					<h3>选择参与数量</h3>
				</div>
				<div class="parti-num-con">
					<div class="choose-item goods-info goods-info-1">
						<div class="goods-pic">
							<img src="images/iphone.jpg" width="72" height="54" alt="">
						</div>
						<div class="goods-related">
							<p class="goods-name-1">苹果专区IPHONE 6S粉红色过年就买新手机过年就买新手机啦！苹果专区IPHONE 6S粉红色过年就买新手机过年就买新手机啦！</p>
							<p>
								<label class="periods-1">期号：23749385</label>
								<span class="unit-price" id="areaUnitPrice">单价￥<b>10</b>元</span>
							</p>
							<div class="clearfix mt-10">
								<div class="qty-box fl clearfix">
									<ul>
										<li class="qty-minus" id="partiDecrease">-</li>
										<!-- <li class="qty-num" id="parti-num">50</li> -->
										<li class="qty-num"><input type="text" id="parti-num" value="50" /></li>
										<li class="qty-plus" id="partiIncrease">+</li>
									</ul>
								</div>
								<span class="statistic fr">共参与<em id="parti-times">50</em>次  合计<b id="amount-money">￥15</b></span>
							</div>							
						</div>
					</div>

					<!-- receive info -->
					<div class="grid mt-10">
						<div class="addr-empty" id="addrNew">
							<div class="grid-hd">			
								<h3>收货信息</h3>							
							</div>			
						</div>
						<div class="address-wrap addr-edit" id="addrEdit" style="display: none;">
							<div class="grid-hd">
								<h3>收货信息</h3>
							</div>					
							<div class="gird-item choose-item receive-info">
								<p><em class="consignee">李晨</em><span class="phone">13622349287</span></p>
								<p class="address">广东 深圳市 南山区 沙河街道比科科技大厦</p>
							</div>						
						</div>
						<input type="hidden" id="addrStatus" value="1" /> <!-- 0: 地址为空 1：地址不为空 -->
					</div>
					
					<div class="choose-item clearfix mt-10">
						<div class="use-stamps fl clearfix">
							<input type="checkbox" id="use-stamps" checked />
							<label for="use-stamps">使用夺宝券</label>
							<span>（剩余：<strong id="remain-stamps">10</strong>张）</span>
						</div>
						<div class="qty-box fr">
							<ul>
								<li class="qty-minus" id="stampsDecrease">-</li>
								<!-- <li class="qty-num" id="stamps-num">10</li> -->
								<li class="qty-num"><input type="text" id="stamps-num" value="10" /></li>
								<li class="qty-plus" id="stampsIncrease">+</li>
							</ul>
						</div>
					</div>
					<div class="choose-item choose-item-pay">
						<p>还需支付<b id="needPayAmount">￥10</b></p>
					</div>
					<div class="total-pay" id="totalPay">￥5</div>
					<a href="#" class="btn btn-block btn-large btn-red">确认参与</a>
				</div>
				<p class="tips-instruct">*使用1张夺宝券可以参与1次夺宝</p>
			</div>
			<!-- participate num end -->

			<!-- address new start -->
			<div class="addr-manage addr-new">				
				<form action="" class="form-addr-manage form-addr-new" id="form-addr-new">
					<p>
						<input type="text" name="consignee" id="consignee" placeholder="收货人" />
					</p>
					<p>
						<input type="text" name="phoneNum" id="phoneNum" placeholder="联系方式" />
					</p>
					<div class="item-area">
						<ul id="addrArea" style="display: none;"></ul>
						<input type="hidden" name="addrArea" id="addrAreaClone" />
					</div>
					<!-- <p class="item-street">
						<select name="addrStreet" id="addrStreet">
							<option selected disabled></option>
							<option value="西乡街道">西乡街道</option>
							<option value="沙河街道">沙河街道</option>
						</select>
					</p> -->
					<p>
						<input type="text" name="addr" id="addr" placeholder="详细地址" />	
					</p>
				</form>
				<input type="submit" form="form-addr-new" class="btn btn-block btn-red" id="btnAddrSave" value="保存" />
			</div>
			<!-- address new end -->
			
			<!-- address edit start -->
			<div class="addr-manage addr-edit">				
				<form action="" class="form-addr-manage form-addr-edit" id="form-addr-edit">
					<p>
						<input type="text" name="consignee1" id="consignee1" placeholder="收货人" value="易陆军" />
					</p>
					<p>
						<input type="text" name="phoneNum1" id="phoneNum1" placeholder="联系方式" value="15818642768" />
					</p>
					<div class="item-area">
						<ul id="addrArea1" style="display: none;"></ul>
						<input type="hidden" name="addrArea1" id="addrAreaClone1" />
					</div>
					<!-- <p class="item-street">
						<select name="addrStreet1" id="addrStreet1">
							<option value="西乡街道" selected>西乡街道</option>
							<option value="沙河街道">沙河街道</option>
						</select>
					</p> -->
					<p>
						<input type="text" name="addr1" id="addr1" placeholder="详细地址" value="牛湾新村" />	
					</p>
				</form>
				<input type="submit" form="form-addr-edit" class="btn btn-block btn-red" id="btnAddrSave1" value="保存" />
			</div>
			<!-- address edit end -->
		</div>

		<div class="fixed-nav">
			<a href="home.html"><i class="icon-nav icon-home"></i>首页</a>
			<a href="share.html" class="active"><i class="icon-nav icon-camera"></i>晒单</a>
			<a href="#"><i class="icon-nav icon-gift"></i>活动</a>
			<a href="cart.html"><i class="icon-nav icon-cart"></i>夺宝车</a>
			<a href="personal_center.html"><i class="icon-nav icon-avatar"></i>个人中心</a>
		</div>

		<!-- jquery lib script -->
		<script src="js/jquery-2.1.4.min.js" type="text/javascript"></script>
		<!-- common script -->
		<script src="js/lib.js" type="text/javascript"></script>
		<!-- jquery layer script -->
		<script src="js/layer/layer.js" type="text/javascript"></script>
		<!-- mobiscroll script -->
		<script src="js/mobiscroll/mobiscroll.core.js" type="text/javascript"></script>
		<script src="js/mobiscroll/mobiscroll.frame.js" type="text/javascript"></script>
		<script src="js/mobiscroll/mobiscroll.scroller.js" type="text/javascript"></script>
		<script src="js/mobiscroll/mobiscroll.select.js" type="text/javascript"></script>
		<script src="js/mobiscroll/mobiscroll.listbase.js" type="text/javascript"></script>
		<script src="js/mobiscroll/mobiscroll.treelist.js" type="text/javascript"></script>
		<script src="js/mobiscroll/i18n/mobiscroll.i18n.zh.js" type="text/javascript"></script>	
		<!-- participate number script -->
		<script src="js/participate_num.js" type="text/javascript"></script>
		<!-- addr manage script -->
		<script src="js/addr_manage.js" type="text/javascript"></script>
		<!-- regiondata script -->
		<script src="js/regiondata.js" type="text/javascript"></script>
		<script>
		 $(function(){
			
			var tmpHtml = '';
			for (var key in window._regionMap) {
				tmpHtml += '<li data-val="'+ window._regionMap[key][0] +'">'+ window._regionMap[key][0];
					tmpHtml += '<ul>';
						var objCity = window._regionMap[key][2];
						for (var key1 in objCity) {
							tmpHtml += '<li cityId="'+ key1 +'" data-val="'+ objCity[key1][0] +'">'+ objCity[key1][0];
								tmpHtml += '<ul>';
									var objArea = objCity[key1][2];
									for (var key2 in  objArea) {
										tmpHtml += '<li areaId="'+ key2 +'" data-val="'+ objArea[key2] +'">'+ objArea[key2] +'</li>';
									}
								tmpHtml += '</ul>';
							tmpHtml += '</li>';
						}
					tmpHtml += '</ul>';
				tmpHtml += '</li>';
			}
			$('#addrArea, #addrArea1').append(tmpHtml);

		 	$('#addrArea').mobiscroll().treelist({
				theme: 'mobiscroll',
				lang: 'zh',
				display: 'bottom',
				fixedWidth: [100, 100, 100],
				placeholder: '省、市、区',
				labels: ['province', 'city', 'district'],
				setText: '完成',
				onSelect:  function (valueText, inst) {
					$('#addrAreaClone').val(valueText);
				}
			});

		 	$('#addrStreet, #addrStreet1').mobiscroll().select({
				theme: 'mobiscroll',
				lang: 'zh',
				display: 'bottom',
				minWidth: 200,
				placeholder: '街道',
				setText: '完成'
			});


			addrInit();
			// 新增地址
			$('#addrNew').on('click', function(){
				$('.participate-num').hide().next('.addr-new').show();
			});
			// 保存
			$('#btnAddrSave').on('click', function(){
				var consigneeVal = $('#consignee').val(),
					phoneNumVal = $('#phoneNum').val(),
					addrAreaVal = $('#addrArea_dummy').val(),
					addrStreetVal = $('#addrStreet_dummy').val(),
					addrDetailVal = $('#addr').val();
				var flag = addrValidat.newAdd();
				if (flag) {
					$('#addrEdit .consignee').text(consigneeVal);
					$('#addrEdit .phone').text(phoneNumVal);
					$('#addrEdit .address').text(addrAreaVal + ' ' + addrStreetVal + ' ' + addrDetailVal);
					luckyBag.isEmptyAddr = 1;
					$('.exchange-num').show().next('.addr-new').hide();
					$('#addrNew').hide().next('#addrEdit').show();
					$('#addrStatus').val(1);
					return false;					
				} 
				return false;
			});
			
			// 编辑地址
			$('#addrEdit').on('click', function(){
				var consigneeVal = $('.consignee').text(),
					phoneNumVal = $('.phone').text();				
				
				var addr = $('.address').text();
				var province = addr.split(' ')[0],
					city = addr.split(' ')[1],
					district = addr.split(' ')[2],
					// street = addr.split(' ')[3],
					detail = addr.split(' ')[3];
					
				$('.participate-num').hide().siblings('.addr-edit').show();
				$('#consignee1').val(consigneeVal);
				$('#phoneNum1').val(phoneNumVal);
				
				// $('#addrStreet1_dummy').val(street);
				$('#addr1').val(detail);
				
				
			
				$('#addrArea1').mobiscroll().treelist({
					theme: 'mobiscroll',
					lang: 'zh',
					display: 'bottom',
					fixedWidth: [100, 100, 100],
					labels: ['province', 'city', 'district'],
					setText: '完成',
					defaultValue: [province, city, district],
					onSelect:  function (valueText, inst) {
						$('#addrAreaClone1').val(valueText);
					}
				});
				$('#addrArea1_dummy').val(province + ' ' + city + ' ' + district);
			});
			// 编辑保存
			$('#btnAddrSave1').on('click', function(){
				var editConsigneeVal = $('#consignee1').val(),
					editPhoneNumVal = $('#phoneNum1').val(),
					editAddrAreaVal = $('#addrArea1_dummy').val(),
					editAddrDetailVal = $('#addr1').val();
				var flag = addrValidat.edit();
				if (flag) {
					$('#addrEdit .consignee').text(editConsigneeVal);
					$('#addrEdit .phone').text(editPhoneNumVal);
					$('#addrEdit .address').text(editAddrAreaVal + ' ' + editAddrDetailVal);
					luckyBag.isEmptyAddr = 1;
					$('.participate-num').show().siblings('.addr-edit').hide();
					$('#addrNew').hide().next('#addrEdit').show();
					$('#addrStatus').val(1);
					return false;					
				} 
				return false;
			});
			
			
		 })
		</script>
		<script>
		var luckyBag = luckyBag || {};	
		luckyBag.area = 1; // 分为一元专区和十元专区
		luckyBag.areaPrice = 1; // 十元专区(单价10元)
		luckyBag.pariNum = 2; // 参与数量
		luckyBag.remainStamps = 10; // 剩余夺宝券张数
		luckyBag.isUseStamps = true; // 默认使用夺宝券
		luckyBag.maxBuyQty = 20; // 最大购买数量(一元专区为20 十元专区为2)
		luckyBag.qtyMin = 1;
		luckyBag.isEmptyAddr = $('#addrStatus').val();
		</script>
	</body>
</html>