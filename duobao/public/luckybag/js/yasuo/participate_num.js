$(function(){fnInit();fnChangePartiNum();fnChangeStampsNum();fnStatusUseStamps()});var fnChangePartiNum=function(){var partiNum=luckyBag.pariNum;var cost;$('#partiIncrease, #partiDecrease').on('click',function(){var num=$('#parti-num').text();if($(this).attr('id')=='partiIncrease'){num++}if($(this).attr('id')=='partiDecrease'){num--;if(num<=luckyBag.qtyMin){num=1}}$('#parti-num').text(num);$('#parti-times').text(num*luckyBag.area);$('#amount-money').text('￥'+num*luckyBag.areaPrice);cost=luckyBag.isUseStamps?($('#amount-money').text().substring(1)-$('#stamps-num').text())*1:$('#amount-money').text().substring(1)*1;$('#needPayAmount, #totalPay').text('￥'+cost)})};var fnChangeStampsNum=function(){var partiNum;var cost;$('#stampsIncrease, #stampsDecrease').on('click',function(){if(!luckyBag.isUseStamps){return}else{var num=$('#stamps-num').text();partiNum=$('#parti-times').text();if($(this).attr('id')=='stampsIncrease'){num++;if(num>=luckyBag.remainStamps){num=luckyBag.remainStamps}}if($(this).attr('id')=='stampsDecrease'){num--;if(num<=luckyBag.qtyMin){num=1}}cost=(partiNum-num)*1;if(num>partiNum){cost=0}$('#stamps-num').text(num);$('#needPayAmount, #totalPay').text('￥'+cost)}})};var fnStatusUseStamps=function(){var useStamps=$('#use-stamps');var cost;useStamps.on('click',function(){var useStampsNum=$('#stamps-num').text();if(!$(this).is(':checked')){cost=$('#parti-times').text();$(this).prop('checked',false);luckyBag.isUseStamps=false;$('#needPayAmount, #totalPay').text('￥'+cost)}else{cost=($('#parti-times').text()-useStampsNum)*1;luckyBag.isUseStamps=true;$(this).prop('checked',true);$('#needPayAmount, #totalPay').text('￥'+cost)}})};var fnInit=function(){var minPartiNum=1;$('#areaUnitPrice b').text(luckyBag.areaPrice);$('#parti-num').text(luckyBag.pariNum);$('#parti-times').text(luckyBag.pariNum*luckyBag.areaPrice);$('#amount-money').text('￥'+luckyBag.pariNum*luckyBag.areaPrice);$('#remain-stamps').text(luckyBag.remainStamps);$('#stamps-num').text(luckyBag.pariNum*luckyBag.areaPrice);var partiNumCost=parseInt($('#amount-money').text().substring(1));var remainStampsUse=parseInt($('#stamps-num').text());var totalCost=partiNumCost-remainStampsUse;if(partiNumCost>=remainStampsUse){totalCost=0}if(luckyBag.pariNum*luckyBag.areaPrice>=luckyBag.remainStamps){$('#stamps-num').text(luckyBag.remainStamps);totalCost=partiNumCost-$('#stamps-num').text()}if(luckyBag.pariNum*luckyBag.areaPrice<=$('#stamps-num').text()){totalCost=0}$('#use-stamps').prop('checked',true);$('#remain-stamps').text(luckyBag.remainStamps);$('#needPayAmount, #totalPay').text('￥'+totalCost)};